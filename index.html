<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador retos Color Code</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
        #reto{
            width: 464px;
            height: 464px;
            border: 1px solid black;
            background-color: grey;
            position:relative;
        }
        #reto > div{
            position:absolute;
            left: 0;
        }
    </style>
</head>
<body>
    <div class="m-0 row justify-content-center text-center">
        <h1>Generador de retos ColorCode</h1>
        <div id="reto">
            
        </div>
    </div>
    <div class="mt-2  gap-3 justify-content-center text-center">
        <button class="btn btn-primary" type="button" id="#download" onclick="DownloadAsImage()">Descargar</button>
        <button class="btn btn-primary" type="button" id="#download" onclick="GenerarReto()">Generar nuevo reto</button>
       
    </div>
   

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.4.1/jspdf.debug.js" type="text/javascript"></script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js" type="text/javascript"></script>
<script>
const rotates = [0, 90, 180, -90];
function GenerarReto(){
    $("#reto").empty();
    const imagenes = Array(18).fill(0).map((e,i)=>i+1)
    imagenes.sort(() => Math.random() - 0.5);
    const cantidad = 4 + Math.floor(Math.random() * 2);
    for(let i = 0; i < cantidad; i++){
        $("#reto").append(`<div><img id="imagen_${i}" src="img/${imagenes[i]}.png"></div>`);
        console.log(imagenes[i]);
        let rotate = rotates[Math.floor(Math.random() * rotates.length)];
        $("#imagen_"+i).css("transform", `rotate(${rotate}deg)`);
    }    
}

GenerarReto();

function downloadURI(uri, name) {
    var link = document.createElement("a");

    link.download = name;
    link.href = uri;
    document.body.appendChild(link);
    link.click();
    //clearDynamicLink(link); 
}

function DownloadAsImage() {
    var element = $("#reto")[0];
    html2canvas(element).then(function (canvas) {
        var myImage = canvas.toDataURL();
        downloadURI(myImage, "reto.png");
    });
}
</script>

</html>